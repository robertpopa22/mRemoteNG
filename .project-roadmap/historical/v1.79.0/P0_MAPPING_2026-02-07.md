# P0 Security Mapping Note

Date: 2026-02-07  
Branch: `codex/release-1.79-bootstrap`

Purpose:
- Map critical upstream issues to concrete fork commits for handoff/PR packaging.

## #2989 - Process/command injection surface

Mapped commits:
- `ef75b890` - main hardening of `Process.Start` usage.
- `31c152dd` - follow-up validation improvements from review.
- `fc854772` - regression tests for AnyDesk ID validation.
- `06e87e33` - compile/review polish.
- `a75cf606` - shell metacharacter escaping expanded (comma/semicolon).

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Connection\Protocol\AnyDesk\ProtocolAnyDesk.cs`
- `D:\github\mRemoteNG\mRemoteNG\Tools\Cmdline\CommandLineArguments.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Connection\Protocol\ProtocolAnydeskTests.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Tools\ExternalToolsArgumentParserTests.cs`

Assessment:
- High-confidence mapped and integrated.

## #3080 - LDAP query/path injection

Mapped commits:
- `3c419ded` - centralized LDAP sanitization, blocked unsafe query/fragment delimiters.
- `8680c53f` - follow-up test compile fix.

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Security\LdapPathSanitizer.cs`
- `D:\github\mRemoteNG\mRemoteNG\Config\Serializers\MiscSerializers\ActiveDirectoryDeserializer.cs`
- `D:\github\mRemoteNG\mRemoteNG\Tools\ADhelper.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Security\LdapPathSanitizerTests.cs`

Assessment:
- High-confidence mapped and integrated.

## #2988 - deserialize/RCE path

Mapped commits:
- `3c419ded` - importer hardening for missing-file scenarios and safer import flow behavior.

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Config\Import\MRemoteNGCsvImporter.cs`
- `D:\github\mRemoteNG\mRemoteNG\Config\Import\MRemoteNGXmlImporter.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Config\Import\MRemoteNGImportersTests.cs`

Assessment:
- Targeted review completed for runtime C# deserialization sinks:
  - no active `BinaryFormatter` / `SoapFormatter` usage found in `*.cs` runtime paths.
  - scanner noise likely comes from `.resx` metadata headers.
- Current state indicates likely false-positive unless a concrete PoC on latest branch is provided.

## Upstream triage comments posted

- #2988 comment:
  - https://github.com/mRemoteNG/mRemoteNG/issues/2988#issuecomment-3864889173
- #3080 comment:
  - https://github.com/mRemoteNG/mRemoteNG/issues/3080#issuecomment-3864889174

Comment intent:
- document mitigation evidence and request concrete reproducible payloads if maintainers want to keep issues open.
- otherwise close as addressed / false-positive.

## Notes

- Upstream issue close/relabel cannot be executed by current account (no `CloseIssue` permission).
- Comment-level triage and evidence linking are complete; maintainer action is still required upstream.
