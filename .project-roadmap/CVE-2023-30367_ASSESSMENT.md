# CVE-2023-30367 Assessment - 2026-02-10

## Issue
**CVE-2023-30367 (CWE-316):** Passwords stored as plaintext `System.String` in process memory. Any tool with memory read access can dump connection passwords.

## Root Cause
`AbstractConnectionRecord.cs:38` stores password as `private string _password = null;`
- `System.String` is immutable and managed by GC — cannot be zeroed
- Password persists in memory until garbage collected (indeterminate)
- The commented-out `SecureString` alternative exists but was never enabled

## Scope of Fix
- **132 references** to `.Password` across **54 files**
- Every serializer (XML, JSON, CSV, SQL), every protocol connector (RDP, VNC, SSH, PowerShell, AnyDesk), every UI form touches the password as a string
- Full fix requires: `string` -> `SecureString` or DPAPI-protected memory across the entire codebase
- Estimated effort: 2-3 weeks of focused work + regression testing

## Decision: Defer to v1.81.0

**Rationale:**
1. v1.80.0 already has significant changes (self-contained builds, .NET 10)
2. SecureString migration touches 54 files — high regression risk if rushed
3. Upstream maintainer (Kvarkas) has been working on this since 2024
4. v1.79.0/v1.80.0 already improve security posture (PBKDF2 600K, HTTPS vaults, master password complexity, process start hardening)

## Mitigation Already in Place (v1.79.0/v1.80.0)
- Master password with complexity enforcement
- Autolock on minimize/idle (#1649)
- Require password to disable protection (#2673)
- PBKDF2 with 600,000 iterations
- HTTPS-only vault connections
- Process start argument hardening

## v1.81.0 Plan
1. Replace `string _password` with `SecureString` in `AbstractConnectionRecord`
2. Add `SecureStringExtensions` helper (marshal to/from unmanaged memory with explicit zeroing)
3. Update all 54 files to use `SecureString` API
4. Pin passwords in unmanaged memory during protocol handshakes
5. Zero memory after use via `CryptProtectMemory` / `Marshal.ZeroFreeGlobalAllocUnicode`
6. Add memory dump test to verify no plaintext passwords remain after connection close
