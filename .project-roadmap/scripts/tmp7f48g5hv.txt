Project: mRemoteNG (.NET 10, WinForms, COM references)
Working directory: D:\github\mRemoteNG
Branch: main

Fix GitHub issue #1008: SmartSize: Add option to preserve aspect ratio

Description:


Recommended approach: Implement logic in ProtocolVNC.cs to handle the 'SmartSAspect' mode by listening to the container's Resize event. Calculate the optimal dimensions for the VNC control to fit within the container while preserving the aspect ratio, and center it. Update ConnectionWindow.cs if necessary to enable the SmartSize toggle for VNC.
Likely files: mRemoteNG/Connection/Protocol/VNC/Connection.Protocol.VNC.cs, mRemoteNG/UI/Window/ConnectionWindow.cs

RULES (CRITICAL):
- Read code BEFORE modifying
- Do NOT change existing behavior â€” only fix the reported issue
- Do NOT create interactive tests (no dialogs, MessageBox, notepad.exe)
- After fixing, run build: powershell.exe -NoProfile -ExecutionPolicy Bypass -File "D:\github\mRemoteNG\build.ps1"
- After build passes, run tests: powershell.exe -NoProfile -ExecutionPolicy Bypass -File "D:\github\mRemoteNG\run-tests.ps1" -NoBuild
- If YOUR change breaks tests, fix it.  If tests fail for unrelated reasons, ignore.
- Do ONLY the fix.  Nothing else.