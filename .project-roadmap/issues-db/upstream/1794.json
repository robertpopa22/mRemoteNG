{
  "number": 1794,
  "repo": "mRemoteNG/mRemoteNG",
  "title": "Crash when closing panel containing a connection tab",
  "state": "open",
  "labels": [
    "Verified",
    "Bug"
  ],
  "author": "oznxzar",
  "created_at": "2020-06-16T05:22:53Z",
  "github_updated_at": "2020-07-25T17:26:28Z",
  "body_snippet": "\r\n\r\n## Expected Behavior\r\nSometimen when I close a tab that contains some open connections inside mremote crash and i need to close it a reset when it shouldn't.\r\n\r\nAs you can see in the error windows something is pointing to path \"C:\\jenkins\\workspace\\Publish\\Build\" that don't exists in my setup\r\n\r\nError Message:\r\n\r\n![image](https://user-images.githubusercontent.com/44467849/84734789-1cbe0780-afa2-11ea-9bf9-e67b7c093b4f.png)\r\n\r\nFull infortmation from error message below:\r\n\r\n```\r\nException Messa...",
  "our_status": "triaged",
  "priority": "P2-bug",
  "target_release": null,
  "our_branch": null,
  "our_pr": null,
  "iterations": [
    {
      "seq": 1,
      "date": "2026-02-21",
      "type": "triaged",
      "description": "Crash when closing a panel with active connection tabs — likely a guard condition gap in ConnectionWindow.Connection_FormClosing() or ClosePanelIfEmptyOnUiTick() causing ObjectDisposedException or NullReferenceException during panel/tab disposal race.",
      "token_usage": {
        "input_tokens": 4,
        "output_tokens": 1365,
        "cost_usd": 0.414072,
        "operations": 1
      }
    }
  ],
  "comments": [
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0NTIyMjI4Mg==",
      "author": "NyvenZA",
      "date": "2020-06-17T08:06:59Z",
      "snippet": "Reproduced with a test tab containing a CEF Browser tab. \r\n\r\nClicking the close button on the \"General\" Tab first causes the crash. Closing the Browser tab first and then general , doesn't cause a problem. \r\n\r\n![image](https://user-images.githubusercontent.com/64709994/84872312-04bdb500-b082-11ea-9b47-af041a7fe8fe.png)\r\n\r\n```\r\nException Message\r\n\"Cannot access a disposed object.\r\nObject name: 'ConnectionWindow'.\"\r\n\r\nStack trace\r\n   at System.Windows.Forms.Control.MarshaledInvoke(Control caller, ...",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0Njg1OTA2Nw==",
      "author": "farosch",
      "date": "2020-06-19T21:01:44Z",
      "snippet": "i couldn't reproduce this but added a check that might fix this issue.\r\ncan anybody confirm this?",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0Njg2NTEwMw==",
      "author": "oznxzar",
      "date": "2020-06-19T21:22:25Z",
      "snippet": "I will check it tomorrow so I will provide feedback about that issue.",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0Njk1NjUxOQ==",
      "author": "oznxzar",
      "date": "2020-06-20T07:18:31Z",
      "snippet": "Hi @farosch , How can I apply the fix you mention? I can't find this file in my mremoteNG Install, if you can provide a new installer or telle how can i check it i will do it.",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0Njk3Mjc5MA==",
      "author": "farosch",
      "date": "2020-06-20T10:15:32Z",
      "snippet": "@oznxzar You can grad the lastest build from Appveyor: https://ci.appveyor.com/project/mremoteng/mremoteng/builds/33630769/job/rcjjfr03bn5u8kkt/artifacts",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0NzE1MzQ3OA==",
      "author": "CraicX",
      "date": "2020-06-21T16:53:26Z",
      "snippet": "I grabbed latest build from link above.  Looks like its still happening.\r\n![issue_1794](https://user-images.githubusercontent.com/46064123/85230416-c4717600-b3a4-11ea-9f98-f86a05dad70e.gif)\r\n",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "MDEyOklzc3VlQ29tbWVudDY0Nzk5ODY2MQ==",
      "author": "NyvenZA",
      "date": "2020-06-23T08:39:48Z",
      "snippet": "Could simulate as above, with the first tabs opening and closing without a crash, but when I open and close second tab, it crashes. \r\n\r\n```\r\nException Message\r\n\"Cannot access a disposed object.\r\nObject name: 'ConnectionWindow'.\"\r\n\r\nStack trace\r\n   at System.Windows.Forms.Control.MarshaledInvoke(Control caller, Delegate method, Object[] args, Boolean synchronous)\r\n   at System.Windows.Forms.Control.Invoke(Delegate method, Object[] args)\r\n   at System.Windows.Forms.Control.Invoke(Delegate method)\r...",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    }
  ],
  "comments_cursor": "2020-07-25T17:26:28Z",
  "unread_comments": 7,
  "needs_action": true,
  "waiting_for_us": true,
  "last_synced": "2026-02-15T09:52:50Z",
  "notes": "AI triage (claude): Crash when closing a panel with active connection tabs — likely a guard condition gap in ConnectionWindow.Connection_FormClosing() or ClosePanelIfEmptyOnUiTick() causing ObjectDisposedException or NullReferenceException during panel/tab disposal race.\nApproach: Add null/disposed guards around connDock.Documents iteration in Connection_FormClosing(), ensure silentClose flag is set before iterating tabs, and protect ClosePanelIfEmptyOnUiTick() against disposed connDock state when panel close is user-initiated rather than tab-removal-triggered.",
  "token_usage": {
    "input_tokens": 4,
    "output_tokens": 1365,
    "cost_usd": 0.414072
  }
}
