{
  "number": 755,
  "repo": "mRemoteNG/mRemoteNG",
  "title": "Window Selection Behaviour",
  "state": "open",
  "labels": [
    "Bug"
  ],
  "author": "dcotruta",
  "created_at": "2017-10-28T16:42:39Z",
  "github_updated_at": "2026-02-21T10:24:23Z",
  "body_snippet": "With version 1.75.7008.17907 on Windows 10, I'm seeing some very funky window selection behaviour. With mRemoteNG selected and on top (whether maximized or not) selecting another window from the taskbar sometimes results in that window being minimized instead of being brought to the front (as if mRemoteNG was not selected). I'm not a Windows expert but I would guess that it's something to do with the way that the application is declaring its focus to the OS.\r\n\r\nIt does not happen all the time, a...",
  "our_status": "testing",
  "priority": "P2-bug",
  "target_release": null,
  "our_branch": null,
  "our_pr": null,
  "iterations": [
    {
      "seq": 1,
      "date": "2026-02-16",
      "type": "triaged",
      "description": "The issue has clear reproduction details and maps directly to existing custom activation/refocus handling where a taskbar focus edge case is plausible."
    },
    {
      "seq": 2,
      "date": "2026-02-16",
      "type": "triaged",
      "description": "The issue has a clear repro and matches known focus edge cases in our WinForms message-interception path, so it is actionable as a bug fix."
    },
    {
      "seq": 3,
      "date": "2026-02-16",
      "type": "triaged",
      "description": "The issue has a concrete repro and matches known focus/refocus edge cases in main-window message interception, so it is actionable as a bug fix."
    },
    {
      "seq": 4,
      "date": "2026-02-16",
      "type": "testing",
      "description": "Fix in 436b46cf"
    }
  ],
  "comments": [
    {
      "id": "MDEyOklzc3VlQ29tbWVudDM0MTA4ODY0NQ==",
      "author": "sparerd",
      "date": "2017-11-01T12:07:07Z",
      "snippet": "Yea there have always been some slightly weird window focus issues in the app. There are a few cases where we have to intercept windows display messages to make putty window focus work a bit more naturally. My guess is that there is an edge case there that we aren't accounting for and it's causing this behavior.\r\n\r\nFor reference, this is happening in frmMain.cs in method \r\n`protected override void WndProc(ref System.Windows.Forms.Message m)`",
      "is_ours": false,
      "analyzed": false,
      "action_needed": true
    },
    {
      "id": "IC_kwDOAAcIMM7o3htz",
      "author": "robertpopa22",
      "date": "2026-02-16T07:28:57Z",
      "snippet": "**Fix available for testing**\n\n**Commit:** [`436b46cf`](https://github.com/robertpopa22/mRemoteNG/commit/436b46cf8372a320010100a36d755f65c43c2767)\n**Branch:** `main`\n**What changed:** Gate/refine WM_ACTIVATEAPP and foreground-focus calls so mRe\n\n**Download latest beta:** [v1.81.0-beta.2](https://github.com/robertpopa22/mRemoteNG/releases/tag/v1.81.0-beta.2)\n\nPlease test and report if this resolves your issue.\n\n---\n_Automated by mRemoteNG Issue Intelligence System_",
      "is_ours": true,
      "analyzed": false,
      "action_needed": false
    }
  ],
  "comments_cursor": "2026-02-21T10:24:23Z",
  "unread_comments": 1,
  "needs_action": true,
  "waiting_for_us": false,
  "last_synced": "2026-02-21T12:06:48Z",
  "notes": "AI triage (codex): The issue has clear reproduction details and maps directly to existing custom activation/refocus handling where a taskbar focus edge case is plausible.\nApproach: Gate/refine WM_ACTIVATEAPP and foreground-focus calls so mRemoteNG does not steal or confuse taskbar window activation, then regression-test PuTTY and RDP focus behavior.\nAI triage (codex): The issue has a clear repro and matches known focus edge cases in our WinForms message-interception path, so it is actionable as a bug fix.\nApproach: Harden WM_ACTIVATEAPP/WM_ACTIVATE handling to prevent unintended refocus during taskbar app switches, then verify with integrated PuTTY and non-PuTTY tabs.\nAI triage (codex): The issue has a concrete repro and matches known focus/refocus edge cases in main-window message interception, so it is actionable as a bug fix.\nApproach: Tighten WndProc refocus gating so ActivateConnection runs only on true app reactivation and not during taskbar-driven window switches/minimize flows."
}
