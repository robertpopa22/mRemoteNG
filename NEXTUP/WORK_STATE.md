# Work State Tracker

Last updated: 2026-02-08 (session 40)  
Branch: `codex/release-1.79-bootstrap`

## Current Objective

Phase 2: P0 security integration and critical issue burn-down.

## Baseline Evidence

- Fork: `https://github.com/robertpopa22/mRemoteNG`
- Upstream remote configured to `mRemoteNG/mRemoteNG`.
- Open issues observed upstream: `830`.
- x64 solution build: passes with warnings.
- arm64 solution build: passes with warnings.
- `dotnet build` is not sufficient for this solution because of COMReference (`MSB4803`); full MSBuild is required for reliable validation.

## Completed

- [x] Create persistent modernization workspace in `NEXTUP/`.
- [x] Maintain local analysis home at `D:\github\LOCAL\analysis\mRemoteNG`.
- [x] Capture issue package baseline and counts.
- [x] Add reproducible issue snapshot script: `NEXTUP/scripts/refresh-issues.ps1`.
- [x] Align TFM to `net10.0-windows10.0.26100.0` in:
  - `mRemoteNGTests/mRemoteNGTests.csproj`
  - `mRemoteNGSpecs/mRemoteNGSpecs.csproj`
  - `ExternalConnectors/ExternalConnectors.csproj`
  - `ObjectListView/ObjectListView.NetCore.csproj`
- [x] Remove direct WiX installer project dependency from tests.
- [x] Preserve installer unit coverage by compiling linked `InstalledWindowsUpdateChecker.cs` in tests.
- [x] Reintroduce SpecFlow package references for specs.
- [x] Fix test compile errors exposed after framework alignment.
- [x] Verify with full MSBuild (Release|x64):
  - `mRemoteNGTests` compiles
  - `mRemoteNGSpecs` compiles
  - `mRemoteNG.sln` builds
- [x] Resolve arm64 satellite resource build blocker by forcing core satellite assembly generation for arm64:
  - `mRemoteNG/mRemoteNG.csproj`
- [x] Verify with full MSBuild (Release|ARM64):
  - `mRemoteNG/mRemoteNG.csproj` builds
  - `mRemoteNG.sln` builds
- [x] Add PR validation workflow with full MSBuild gates:
  - `.github/workflows/pr_validation.yml`
  - build matrix for solution (`x64`, `ARM64`)
  - explicit test/spec build job (`x64`)
- [x] Validate first GitHub Actions execution for PR validation workflow:
  - Run: `PR_Validation` #`21781330218`
  - Result: `success`
  - URL: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21781330218`
- [x] Validate second GitHub Actions execution for PR validation workflow:
  - Run: `PR_Validation` #`21781383069`
  - Result: `success`
  - URL: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21781383069`
- [x] Integrate upstream security-oriented PR content into fork branch:
  - PR #3038 (Process.Start command-injection hardening)
  - PR #3054 (password delimiter escaping for external tools)
- [x] Fix post-integration test regression in `ExternalToolsArgumentParserTests` (`CS1022` due to extra brace).
- [x] Revalidate after security PR integration:
  - `mRemoteNG.sln` (Release|x64) builds
  - `mRemoteNG.sln` (Release|ARM64) builds
  - `mRemoteNGTests` (Release|x64) builds
  - `mRemoteNGSpecs` (Release|x64) builds

## In Progress

- [x] Implement LDAP hardening pass for `#3080`:
  - centralized LDAP path sanitization in `LdapPathSanitizer`
  - blocked LDAP URL query/fragment characters (`?`, `#`)
  - removed duplicated sanitizer logic from:
    - `Config/Serializers/MiscSerializers/ActiveDirectoryDeserializer.cs`
    - `Tools/ADhelper.cs`
- [x] Implement importer guardrail pass for `#2988` attack surface:
  - `MRemoteNGCsvImporter` now returns early on missing file.
  - `MRemoteNGXmlImporter` now returns early on missing file.
- [x] Added targeted regression/security tests:
  - `mRemoteNGTests/Security/LdapPathSanitizerTests.cs`
  - `mRemoteNGTests/Config/Connections/XmlConnectionsLoaderTests.cs`
  - `mRemoteNGTests/Config/Import/MRemoteNGImportersTests.cs`
- [x] CI validation green after patchset push:
  - failed first run due missing `using System` in test file
  - fixed with follow-up commit and rerun
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21781854896`
- [x] Built automated P1-P5 package snapshot tooling:
  - script: `NEXTUP/scripts/refresh-p1-p5.ps1`
  - report: `NEXTUP/P1_P5_EXECUTION_2026-02-07.md`
  - JSON artifacts: `D:\github\LOCAL\analysis\mRemoteNG\packages\*.json`
- [x] P5 fix candidate #3069 implemented and CI-validated:
  - file: `mRemoteNG/UI/Window/ConnectionWindow.cs`
  - hardening: dispose-safe + thread-safe tab close callback in `Prot_Event_Closed`
  - reconnect path simplified to avoid redundant `Invoke`.
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21782034958`
- [x] P5 fix candidate #3092 implemented and CI-validated:
  - file: `ExternalConnectors/OP/OnePasswordCli.cs`
  - fixes:
    - robust `op://` parser supports vault/item names with spaces
    - fallback now supports `CONCEALED` fields for username/password mapping
    - purpose lookup ignores empty values before fallback by label/id
  - tests:
    - `mRemoteNGTests/ExternalConnectors/OnePasswordCliTests.cs`
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21782320844`
- [x] P1 duplicate package triage pass completed (comment-level):
  - all 6 duplicate-labeled open issues reviewed and cross-linked/commented
  - close action blocked by upstream permission (`CloseIssue` denied for current account)
  - execution log: `NEXTUP/P1_P2_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P2 batch-1 triage pass completed:
  - 25 oldest stale `Need 2 check` issues received reproducibility refresh comments
  - execution log: `NEXTUP/P1_P2_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P2 batch-2 triage pass completed:
  - next 25 `Need 2 check` issues received reproducibility refresh comments
  - helper script added: `NEXTUP/scripts/comment-p2-need2check-batch.ps1`
  - execution log: `NEXTUP/P1_P2_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P2 batch-3 + extended triage passes executed:
  - additional refresh comments posted to accelerate stale backlog cleanup
  - initial overlap discovered when sorting by `updatedAt`; script corrected to deterministic `createdAt` ordering
  - evidence: `NEXTUP/P1_P2_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P2 stale sweep finalized:
  - additional targeted refresh comments posted for residual stale `Need 2 check` items
  - regenerated snapshot now shows `P2 need2check stale (>365d): 0`
  - evidence:
    - `NEXTUP/P1_P2_TRIAGE_EXECUTION_2026-02-07.md`
    - `NEXTUP/P1_P5_EXECUTION_2026-02-07.md`
- [x] P5 fix candidate #2972 implemented and CI-validated:
  - files:
    - `mRemoteNG/Connection/Protocol/RDP/RdpProtocol.cs`
    - `mRemoteNG/Connection/Protocol/PuttyBase.cs`
  - change:
    - `EmptyCredentials=custom` now respects `ExternalCredentialProviderDefault` for OnePassword/Clickstudios (not only Delinea)
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21783476996`
- [x] P3 stale label triage pass completed (comment-level):
  - stale `In progress` set commented (19 issues)
  - stale `In development` set commented (27 issues)
  - evidence: `NEXTUP/P3_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P0 mapping evidence note completed:
  - file: `NEXTUP/P0_MAPPING_2026-02-07.md`
  - maps #2988/#2989/#3080 to integrated commits and residual risk notes
- [x] P0 issue evidence comments posted upstream:
  - #2988 comment: `https://github.com/mRemoteNG/mRemoteNG/issues/2988#issuecomment-3864889173`
  - #3080 comment: `https://github.com/mRemoteNG/mRemoteNG/issues/3080#issuecomment-3864889174`
- [x] Maintainer close/relabel handoff package created:
  - `NEXTUP/MAINTAINER_HANDOFF_2026-02-07.md`
- [x] Upstream PR split plan documented:
  - `NEXTUP/UPSTREAM_PR_PACKAGES_2026-02-07.md`
- [x] Upstream PR package branches created:
  - PR-1: `https://github.com/mRemoteNG/mRemoteNG/pull/3105`
  - PR-2: `https://github.com/mRemoteNG/mRemoteNG/pull/3106`
  - PR-3: `https://github.com/mRemoteNG/mRemoteNG/pull/3107`
  - PR-4: `https://github.com/mRemoteNG/mRemoteNG/pull/3108`
- [x] Upstream PRs moved from draft to ready-for-review.
- [x] CI evidence comments posted on each upstream PR.
- [x] Upstream PR-5 opened for command-line hardening + external-tools escaping:
  - PR-5: `https://github.com/mRemoteNG/mRemoteNG/pull/3109`
- [x] Windows architecture coverage expanded in fork CI/release workflows:
  - `PR_Validation`: now includes `x86`, `x64`, `ARM64` solution builds
  - `Build_and_Release_mR-NB`: now includes `x86`, `x64`, `ARM64` artifact builds
- [x] CI toolchain uplift for .NET 10 build agents (x86/x64):
  - workflows updated:
    - `.github/workflows/pr_validation.yml`
    - `.github/workflows/Build_mR-NB.yml`
  - x86/x64 jobs now run on `windows-2025-vs2026` with MSBuild `18.x` (`[18.0,19.0)`)
  - ARM64 jobs keep VS/MSBuild `17.14.12` fallback on `windows-11-arm` (current hosted runner limitation)
  - validation:
    - initial direct `18.x` for ARM failed (`Unable to find MSBuild`)
    - fallback patch validated green in CI:
      - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21787921877`
- [x] Root-cause + fix for first `x86` CI breakage (`PR_Validation` run `21784889033`):
  - root causes:
    - missing `Release|x86` and related `x86` mappings in `mRemoteNG.sln`
    - missing `x86` platform/config blocks in project files
    - `x86` test build hit duplicate assembly attributes because `GenerateAssemblyInfo` was not disabled for new x86 configs in `mRemoteNG.csproj`
  - fixes applied:
    - added `x86` solution configurations and project mappings in `mRemoteNG.sln`
    - enabled `x86` platform declarations in:
      - `mRemoteNG/mRemoteNG.csproj`
      - `ExternalConnectors/ExternalConnectors.csproj`
      - `mRemoteNGTests/mRemoteNGTests.csproj`
      - `mRemoteNGSpecs/mRemoteNGSpecs.csproj`
    - added `x86` platform target handling in:
      - `mRemoteNG/mRemoteNG.csproj`
      - `ObjectListView/ObjectListView.NetCore.csproj`
    - added x86 configuration property groups in `mRemoteNG/mRemoteNG.csproj` (`Debug`, `Release`, `Debug Portable`, `Release Portable`, `Release Installer`, `Deploy to github`)
- [x] Verified x86 remediation in CI:
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21785039669`
  - result: `success`
  - jobs green:
    - `Build solution (x86)`
    - `Build tests and specs (x86)`
    - `Build solution (x64)`
    - `Build tests and specs (x64)`
    - `Build solution (ARM64)`
- [x] Head-state CI check after PR-6 documentation sync:
  - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21785223094`
  - result: `success`
  - jobs green: `Build solution/tests` on `x86`, `x64`, `ARM64`
- [x] Implemented SQL Server connector packaging hardening for issue `#3005`:
  - change:
    - explicit `Microsoft.Data.SqlClient.SNI`
    - explicit `Microsoft.Data.SqlClient.SNI.runtime`
    - file: `mRemoteNG/mRemoteNG.csproj`
  - validation:
    - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21785156992`
    - result: `success` (`x86`, `x64`, `ARM64`)
  - upstream PR:
    - `https://github.com/mRemoteNG/mRemoteNG/pull/3110`
  - upstream issue cross-link comment:
    - `https://github.com/mRemoteNG/mRemoteNG/issues/3005#issuecomment-3865102490`
- [x] P4 version-label debt triage automation + first batch completed:
  - new script:
    - `NEXTUP/scripts/comment-p4-version-debt-batch.ps1`
  - batches posted:
    - 36 issue comments with retest/relabel guidance
  - evidence:
    - `NEXTUP/P4_TRIAGE_EXECUTION_2026-02-07.md`
- [x] P5 panel empty-state follow-up implemented:
  - file:
    - `mRemoteNG/UI/Window/ConnectionWindow.cs`
  - change:
    - when the last tab closes, panel now auto-closes in a guarded/debounced UI-safe path
  - validation:
    - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21785604947`
    - result: `success` (`x86`, `x64`, `ARM64`)
- [x] P4 version-label debt comment triage exhausted (stateful):
  - script updates:
    - `NEXTUP/scripts/comment-p4-version-debt-batch.ps1`
    - `NEXTUP/scripts/run-p4-to-exhaustion.ps1`
  - state file:
    - `NEXTUP/p4_state_processed.txt` (`328` processed issue IDs)
  - runner terminal state:
    - `No version-debt issues found ... DONE after 7 rounds`
- [x] SQL provider/serializer compatibility hardening for legacy DB schemas (issue `#1916` candidate):
  - files:
    - `mRemoteNG/Config/DataProviders/SqlDataProvider.cs`
    - `mRemoteNG/Config/Serializers/ConnectionSerializers/Sql/DataTableSerializer.cs`
    - `mRemoteNGTests/Config/Serializers/DataTableSerializerTests.cs`
  - change:
    - always load SQL reader schema even when `tblCons` has 0 rows
    - auto-add missing serializer columns when source SQL schema is partial/outdated
    - add regression test for missing-column source schema
  - CI validation:
    - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21786116643`
    - result: `success` (`x86`, `x64`, `ARM64`)
  - upstream issue updates:
    - `#1916`: `https://github.com/mRemoteNG/mRemoteNG/issues/1916#issuecomment-3865218242`
    - `#1883`: `https://github.com/mRemoteNG/mRemoteNG/issues/1883#issuecomment-3865226419`
    - `#2290`: `https://github.com/mRemoteNG/mRemoteNG/issues/2290#issuecomment-3865226895`
- [x] Upstream PR-7 opened for SQL schema compatibility hardening:
  - branch: `codex/pr7-sql-schema-compat-1916`
  - PR: `https://github.com/mRemoteNG/mRemoteNG/pull/3111`
  - CI evidence comment:
    - `https://github.com/mRemoteNG/mRemoteNG/pull/3111#issuecomment-3865236823`
- [x] P5 fix candidate #850 implemented and CI-validated:
  - file:
    - `mRemoteNG/UI/Window/ConfigWindow.cs`
  - change:
    - preserve Config PropertyGrid label/value splitter width across minimize/maximize and resize layout cycles
    - runtime-safe reflection fallback for WinForms internal splitter APIs
  - CI validation:
    - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21786942297`
    - result: `success` (`x86`, `x64`, `ARM64`)
  - upstream PR:
    - `https://github.com/mRemoteNG/mRemoteNG/pull/3112`
  - upstream issue update:
    - `#850`: `https://github.com/mRemoteNG/mRemoteNG/issues/850#issuecomment-3865499466`
- [x] P5 fix candidate #1969 implemented and upstream-packaged:
  - files:
    - `mRemoteNG/Connection/ConnectionsService.cs`
    - `mRemoteNGTests/Connection/ConnectionsServiceStartupPathTests.cs`
  - change:
    - startup file path now falls back to default when `ConnectionFilePath` is `null`, empty, or whitespace
    - regression test coverage added for `null`, empty, and whitespace values
  - fork CI validation evidence:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21787167552`
  - upstream PR:
    - `https://github.com/mRemoteNG/mRemoteNG/pull/3113`
  - upstream issue update:
    - `https://github.com/mRemoteNG/mRemoteNG/issues/1969#issuecomment-3865576670`
- [x] Windows compatibility baseline lowered for broader client coverage while keeping `.NET 10`:
  - changed from `windows10.0.26100.0` to `windows10.0.19041.0` across:
    - `mRemoteNG/mRemoteNG.csproj`
    - `ExternalConnectors/ExternalConnectors.csproj`
    - `ObjectListView/ObjectListView.NetCore.csproj`
    - `mRemoteNGSpecs/mRemoteNGSpecs.csproj`
    - `mRemoteNGTests/mRemoteNGTests.csproj`
  - local validation:
    - solution build: `Release|x86`, `Release|x64`, `Release|ARM64`
    - tests/specs build: `Release|x86`, `Release|x64`
  - fork CI validation:
    - run: `https://github.com/robertpopa22/mRemoteNG/actions/runs/21787440752`
    - result: `success` (`x86`, `x64`, `ARM64`, tests/specs)
- [x] Stability duplicate-triage follow-up for close-tab crash cluster:
  - issue `#3062` cross-linked as likely duplicate of `#3069` (same `Prot_Event_Closed` disposed-object call path)
  - upstream triage comment:
    - `https://github.com/mRemoteNG/mRemoteNG/issues/3062#issuecomment-3865581826`
  - mapped fix PR:
    - `https://github.com/mRemoteNG/mRemoteNG/pull/3106`
- [x] Upstream issue cross-link pass for already-packaged P5 fixes:
  - `#3044` -> `https://github.com/mRemoteNG/mRemoteNG/issues/3044#issuecomment-3865585451` (mapped PR `#3109`)
  - `#3092` -> `https://github.com/mRemoteNG/mRemoteNG/issues/3092#issuecomment-3865585855` (mapped PR `#3107`)
  - `#2972` -> `https://github.com/mRemoteNG/mRemoteNG/issues/2972#issuecomment-3865586187` (mapped PR `#3108`)
  - `#3069` -> `https://github.com/mRemoteNG/mRemoteNG/issues/3069#issuecomment-3865586563` (mapped PR `#3106`)
- [x] P5 startup resilience hardening for PuTTY session provider failures (issue `#822` candidate):
  - file:
    - `mRemoteNG/Config/Putty/PuttySessionsManager.cs`
  - change:
    - provider-level exception guard added in `AddSessionsFromProvider`; broken PuTTY session sources no longer abort connections-file load/startup
  - regression test:
    - `mRemoteNGTests/Connection/ConnectionsServicePuttySessionsResilienceTests.cs`
  - local validation:
    - full Framework MSBuild build of `mRemoteNGTests` (`Release|x64`) passed
    - targeted test filter `FullyQualifiedName~ConnectionsService` passed (`4/4`)
- [x] P5 startup XML resilience hardening for malformed `confCons.xml` (issue `#811` candidate):
  - files:
    - `mRemoteNG/Config/Connections/XmlConnectionsLoader.cs`
    - `mRemoteNG/Config/Serializers/ConnectionSerializers/Xml/XmlConnectionsDeserializer.cs`
    - `mRemoteNGTests/Config/Connections/XmlConnectionsLoaderTests.cs`
  - change:
    - when startup XML parsing fails, loader now attempts deterministic recovery from the newest valid `*.backup` file
    - successful recovery auto-restores the primary file from backup
    - deserializer now throws explicit `XmlException` on unparsable XML document state (instead of null-reference failure path)
  - local validation:
    - full Framework MSBuild build of `mRemoteNGTests` (`Release|x64`) passed
    - targeted test filter `FullyQualifiedName~XmlConnectionsLoaderTests` passed (`4/4`)
    - startup sanity filter `FullyQualifiedName~ConnectionsService` passed (`4/4`)
- [x] P5 PuTTY CJK session name decode hardening (issue `#2785` candidate):
  - files:
    - `mRemoteNG/Config/Putty/PuttySessionNameDecoder.cs`
    - `mRemoteNG/Config/Putty/PuttySessionsRegistryProvider.cs`
    - `mRemoteNG/Config/Putty/AbstractPuttySessionsProvider.cs`
    - `mRemoteNGTests/Config/Putty/PuttySessionNameDecoderTests.cs`
  - change:
    - centralized PuTTY session-name decoding with UTF-8-first strategy and deterministic fallback for legacy non-UTF8 percent-encoded names
    - provider and removal-path normalization now share the same decode logic
  - local validation:
    - full Framework MSBuild build of `mRemoteNGTests` (`Release|x64`) passed
    - targeted test filter `FullyQualifiedName~PuttySessionNameDecoderTests` passed (`3/3`)
    - regression sanity retained:
      - `FullyQualifiedName~XmlConnectionsLoaderTests` passed (`4/4`)
      - `FullyQualifiedName~ConnectionsService` passed (`4/4`)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21789090820`
  - upstream packaging:
    - PR `#3115`: `https://github.com/mRemoteNG/mRemoteNG/pull/3115`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2785#issuecomment-3865800159`
- [x] P5 SmartSize focus resilience hardening (issue `#2735` candidate):
  - file:
    - `mRemoteNG/UI/Forms/frmMain.cs`
  - change:
    - on `WM_ACTIVATEAPP` when app is re-activated and `DisableRefocus=false`, queued activation now explicitly re-focuses active connection protocol
    - `ActivateConnection()` now uses resilient active-tab discovery fallback (`DockPane` and `DockPanel.ActiveContent`) instead of relying only on `ConnectionWindow.ActiveControl`
  - local validation:
    - full Framework MSBuild build of solution (`Release|x64`) passed
    - targeted regressions passed:
      - `FullyQualifiedName~ConnectionsService` (`4/4`)
      - `FullyQualifiedName~XmlConnectionsLoaderTests` (`4/4`)
      - `FullyQualifiedName~PuttySessionNameDecoderTests` (`3/3`)
    - note:
      - existing unrelated unstable test observed in local run:
        - `RdpProtocol8ResizeTests.MinimizeRestore_Sequence_WorksCorrectly` (expected `DoResizeClientCallCount=1`, got `0`)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21789349478`
  - upstream packaging:
    - PR `#3116`: `https://github.com/mRemoteNG/mRemoteNG/pull/3116`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2735#issuecomment-3865832228`
- [x] P5 RDP fullscreen/redirect-keys guardrail (issue `#847` candidate):
  - files:
    - `mRemoteNG/Connection/Protocol/RDP/RdpProtocol.cs`
    - `mRemoteNG/UI/Window/ConnectionWindow.cs`
  - change:
    - exposed runtime read-only flag `RedirectKeysEnabled` on `RdpProtocol`
    - context-menu fullscreen toggle now disables only when `RedirectKeysEnabled` and already fullscreen
    - fullscreen action now no-ops in that locked state to prevent accidental exit
  - local validation:
    - full Framework MSBuild build of solution (`Release|x64`) passed
    - targeted regressions passed:
      - `FullyQualifiedName~ConnectionsService` (`4/4`)
      - `FullyQualifiedName~XmlConnectionsLoaderTests` (`4/4`)
      - `FullyQualifiedName~PuttySessionNameDecoderTests` (`3/3`)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21789456797`
  - upstream packaging:
    - PR `#3117`: `https://github.com/mRemoteNG/mRemoteNG/pull/3117`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/847#issuecomment-3865842009`
- [x] P5 fullscreen-exit refocus hardening (issue `#1650` candidate):
  - file:
    - `mRemoteNG/Connection/Protocol/RDP/RdpProtocol.cs`
  - change:
    - when RDP raises `OnLeaveFullScreenMode`, handler now restores main form from minimized state if needed, activates main window, and refocuses the active session control
    - prevents window-background/focus-loss behavior after leaving fullscreen via RDP connection bar
  - local validation:
    - full Framework MSBuild build of solution (`Release|x64`) passed
    - targeted regression passed:
      - `FullyQualifiedName~ConnectionsService` (`4/4`)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21789549099`
  - upstream packaging:
    - PR `#3118`: `https://github.com/mRemoteNG/mRemoteNG/pull/3118`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/1650#issuecomment-3865854500`
- [x] Refreshed P1-P5 execution snapshot (2026-02-08):
  - report:
    - `NEXTUP/P1_P5_EXECUTION_2026-02-08.md`
  - JSON artifacts:
    - `D:\github\LOCAL\analysis\mRemoteNG\packages\*.json`
- [x] Added persistent command-learning system to reduce repeated execution errors:
  - rules:
    - `NEXTUP/LESSONS.md`
  - logs:
    - `NEXTUP/COMMAND_FEEDBACK_LOG.md`
    - `NEXTUP/command-feedback.jsonl`
  - tooling:
    - `NEXTUP/scripts/log-command-feedback.ps1`
    - `NEXTUP/scripts/find-lesson.ps1`
- [x] Added frequency/time-loss metrics for command failures and slow actions:
  - script:
    - `NEXTUP/scripts/refresh-command-feedback-metrics.ps1`
  - report:
    - `NEXTUP/COMMAND_FEEDBACK_METRICS.md`
  - log schema update:
    - `Duration(s)` and `Lost(s)` in `COMMAND_FEEDBACK_LOG.md`
    - `duration_seconds` and `lost_time_seconds` in `command-feedback.jsonl`
- [x] Added short alias launcher for readable command execution:
  - script:
    - `NEXTUP/scripts/nx.cmd`
  - aliases:
    - `g|git`, `h|gh`, `p|ps`, `lesson`, `metrics`, `paths`
  - interactive shell integration:
    - `D:\github\LOCAL\env.cmd` now defines `nx`, `nxpaths`, `nxlesson`, `nxmetrics`
- [x] P5 RCW/COM resilience hardening for RDP resize path (issue `#2510` candidate):
  - files:
    - `mRemoteNG/Connection/Protocol/RDP/RdpProtocol.cs`
    - `mRemoteNG/Connection/Protocol/RDP/RdpProtocol8.cs`
  - change:
    - removed unsafe RCW recreation fallback in `SmartSize` getter/setter
    - `SmartSize` access now handles invalid/disconnected COM object states without surfacing popup exceptions
    - resize path now skips when RDP controls are disposed/unavailable
  - local validation:
    - local full-framework MSBuild validation currently blocked in this shell runtime by SDK resolver/tooling mismatch
    - patch queued for CI validation on push (`PR_Validation` matrix)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21793657159`
  - upstream packaging:
    - PR `#3119`: `https://github.com/mRemoteNG/mRemoteNG/pull/3119`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2510#issuecomment-3866311674`
- [x] P5 settings-path observability hardening for startup recovery (issue `#2987` candidate):
  - files:
    - `mRemoteNG/App/Info/SettingsFileInfo.cs`
    - `mRemoteNG/App/Initialization/StartupDataLogger.cs`
    - `mRemoteNGDocumentation/troubleshooting.rst`
  - change:
    - expose resolved per-user settings file path via `SettingsFileInfo.UserSettingsFilePath`
    - startup now logs `User settings file: <full path>` for deterministic recovery/debug
    - troubleshooting docs now clarify installed vs portable settings file locations
  - local validation:
    - local .NET SDK build path still blocked for full solution validation by COMReference requirement (`MSB4803`)
    - full validation remains CI-first for this repo/toolchain
  - upstream packaging:
    - PR `#3120`: `https://github.com/mRemoteNG/mRemoteNG/pull/3120`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2987#issuecomment-3866329467`
- [x] P5 password-protection disable guardrail (`#2673`):
  - files:
    - `mRemoteNG/Tree/Root/RootNodeInfo.cs`
    - `mRemoteNG/UI/Controls/ConnectionInfoPropertyGrid/ConnectionInfoPropertyGrid.cs`
    - `mRemoteNG/UI/Forms/FrmPassword.cs`
    - `mRemoteNGTests/Tree/RootNodeInfoTests.cs`
  - change:
    - disabling root `Password protect` now requires current password confirmation
    - if password prompt is cancelled or mismatched, protection remains enabled
    - fixed `FrmPassword` new-password flow so `OK` is blocked on verify mismatch
    - added root password-matching tests (including disabled-flag scenario)
  - local validation:
    - `dotnet test mRemoteNGTests\mRemoteNGTests.csproj --filter FullyQualifiedName~RootNodeInfoTests` still blocked at project build by COMReference requirement (`MSB4803`)
    - CI-first validation remains required for this environment
  - upstream packaging:
    - PR `#3121`: `https://github.com/mRemoteNG/mRemoteNG/pull/3121`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2673#issuecomment-3866347072`
    - CI evidence comment:
      - `https://github.com/mRemoteNG/mRemoteNG/pull/3121#issuecomment-3866359364`
- [x] P5 master-password autolock on minimize/idle (`#1649`):
  - files:
    - `mRemoteNG/Tree/Root/RootNodeInfo.cs`
    - `mRemoteNG/UI/Controls/ConnectionInfoPropertyGrid/ConnectionInfoPropertyGrid.cs`
    - `mRemoteNG/UI/Forms/frmMain.cs`
    - `mRemoteNG/Tools/NotificationAreaIcon.cs`
    - `mRemoteNG/App/NativeMethods.cs`
    - `mRemoteNG/Config/Serializers/ConnectionSerializers/Xml/XmlRootNodeSerializer.cs`
    - `mRemoteNG/Config/Serializers/ConnectionSerializers/Xml/XmlConnectionsDeserializer.cs`
    - tests:
      - `mRemoteNGTests/Config/Serializers/ConnectionSerializers/Xml/XmlRootNodeSerializerTests.cs`
      - `mRemoteNGTests/Config/Serializers/ConnectionSerializers/Xml/XmlConnectionsDeserializerTests.cs`
      - `mRemoteNGTests/Tree/RootNodeInfoTests.cs`
  - change:
    - add root option `Auto lock on minimize` (available only when `Password protect` is enabled)
    - when enabled, app autolocks on minimize and after 5 minutes of system inactivity
    - restore from tray/taskbar now requires current master password while locked
    - autolock setting is persisted via root XML attribute `AutoLockOnMinimize`
  - local validation:
    - full-framework MSBuild build for `mRemoteNGTests` (`Release|x64`) passed using VS Build Tools + .NET SDK path setup
    - targeted tests passed:
      - `FullyQualifiedName~AutoLockOnMinimizeSerialized` (`2/2`)
      - `FullyQualifiedName~RootNodeAutoLockOnMinimizeGetsDeserialized` (`1/1`)
      - `FullyQualifiedName~AutoLockOnMinimizeIsDisabledByDefault` (`1/1`)
      - `FullyQualifiedName~RootNodeInfoTests` (`18/18`)
  - fork CI validation:
    - `https://github.com/robertpopa22/mRemoteNG/actions/runs/21794326986`
  - upstream packaging:
    - PR `#3122`: `https://github.com/mRemoteNG/mRemoteNG/pull/3122`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/1649#issuecomment-3866405356`
    - CI evidence comment:
      - `https://github.com/mRemoteNG/mRemoteNG/pull/3122#issuecomment-3866406010`
- [x] P5 triage consolidation for likely stale/no-repro runtime issues:
  - issue `#1880` comment:
    - `https://github.com/mRemoteNG/mRemoteNG/issues/1880#issuecomment-3866421863`
  - issue `#2653` comment:
    - `https://github.com/mRemoteNG/mRemoteNG/issues/2653#issuecomment-3866422644`
- [x] P5 external-tool protocol token support (`#1634`):
  - files:
    - `mRemoteNG/Tools/ExternalToolArgumentParser.cs`
    - `mRemoteNGTests/Tools/ExternalToolsArgumentParserTests.cs`
  - change:
    - added `protocol` replacement variable in external tool argument parser
    - added parser coverage for `%PROTOCOL%`, `%-PROTOCOL%`, `%!PROTOCOL%`
  - local validation:
    - full-framework MSBuild solution build (`Release|x64`) passed
    - targeted parser tests passed via vstest filter:
      - `FullyQualifiedName~mRemoteNGTests.Tools.ExternalToolsArgumentParserTests` (`37/37`)
  - upstream packaging:
    - PR `#3123`: `https://github.com/mRemoteNG/mRemoteNG/pull/3123`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/1634#issuecomment-3866512854`
- [x] P5 main close cancel behavior with open panels (`#2270`):
  - file:
    - `mRemoteNG/UI/Forms/frmMain.cs`
  - change:
    - reordered shutdown flow so main form is not hidden before child panel close confirmations complete
    - when a child panel close is cancelled (user clicks `No`), main app close is cancelled and window remains visible
    - extracted helper `GetOpenConnectionsCount()` for deterministic open-connection checks
  - local validation:
    - full-framework MSBuild restore/build passed (`Release|x64`)
    - note: `OptionsFormTests` still has pre-existing unstable failures in this environment (not introduced by this patch)
  - upstream packaging:
    - PR `#3124`: `https://github.com/mRemoteNG/mRemoteNG/pull/3124`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2270#issuecomment-3866527936`
- [x] P5 startup XML recovery package opened upstream (`#811`):
  - files:
    - `mRemoteNG/Config/Connections/XmlConnectionsLoader.cs`
    - `mRemoteNG/Config/Serializers/ConnectionSerializers/Xml/XmlConnectionsDeserializer.cs`
    - `mRemoteNGTests/Config/Connections/XmlConnectionsLoaderTests.cs`
  - upstream packaging:
    - PR `#3125`: `https://github.com/mRemoteNG/mRemoteNG/pull/3125`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/811#issuecomment-3867038036`
- [x] P5 empty-panel close package opened upstream (`#2160`):
  - file:
    - `mRemoteNG/UI/Window/ConnectionWindow.cs`
  - change:
    - auto-close panel when last tab closes and no documents remain
    - defer panel close to UI tick and guard against dispose/invalid-handle races
    - skip empty-panel auto-close when full app shutdown is already in progress
  - upstream packaging:
    - PR `#3126`: `https://github.com/mRemoteNG/mRemoteNG/pull/3126`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2160#issuecomment-3867237778`
- [x] P5 document-tab drag autoscroll package opened upstream (`#2161`):
  - file:
    - `mRemoteNG/UI/Tabs/DockPaneStripNG.cs`
  - change:
    - restore left/right edge-triggered tab-strip autoscroll while dragging in document overflow mode
    - throttle drag autoscroll updates to reduce jumpy behavior
    - keep scope isolated to `DockPaneStripNG` without dependency/package changes
  - upstream packaging:
    - PR `#3127`: `https://github.com/mRemoteNG/mRemoteNG/pull/3127`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2161#issuecomment-3867296728`
- [x] P5 Config/Connections panel-position persistence package opened upstream (`#2171`):
  - file:
    - `mRemoteNG/UI/Forms/frmMain.cs`
  - change:
    - stop forcing `Connections` panel focus immediately after dock-layout restore
    - preserve active Config/Connections panel restored from persisted layout
    - keep fallback focus only when no active dock content is restored
  - upstream packaging:
    - PR `#3128`: `https://github.com/mRemoteNG/mRemoteNG/pull/3128`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2171#issuecomment-3867317211`
- [x] P5 tab/panel crash+resize hardening package opened upstream (`#2166`):
  - file:
    - `mRemoteNG/UI/Tabs/DockPaneStripNG.cs`
  - change:
    - validate tab index/content before close action
    - queue tab close on UI message loop to avoid close-during-layout races
    - handle transient docking race exceptions in queued close path without app crash
  - local validation:
    - `dotnet build mRemoteNG.sln -c Release -p:Platform=x64` reaches known COMReference gate (`MSB4803`) on .NET Core MSBuild path
    - full-framework build succeeds when SDK is made discoverable in shell:
      - `set PATH=C:\Progra~1\dotnet;%PATH% && C:\Progra~2\MICROS~4\2022\BuildTools\MSBuild\Current\Bin\MSBuild.exe mRemoteNG.sln /m /p:Configuration=Release /p:Platform=x64 /t:Build`
  - upstream packaging:
    - PR `#3129`: `https://github.com/mRemoteNG/mRemoteNG/pull/3129`
    - issue update comment:
      - `https://github.com/mRemoteNG/mRemoteNG/issues/2166#issuecomment-3867358613`
    - note:
      - form-closing enumeration trace from `#2166` is already covered by PR `#3124`
- [x] Added issue-family parent links for disposed-object close-path cluster (mapped to PR `#3106`):
  - issue comments:
    - `#2118`: `https://github.com/mRemoteNG/mRemoteNG/issues/2118#issuecomment-3867046750`
    - `#2163`: `https://github.com/mRemoteNG/mRemoteNG/issues/2163#issuecomment-3867046749`
    - `#2459`: `https://github.com/mRemoteNG/mRemoteNG/issues/2459#issuecomment-3867046753`
    - `#2706`: `https://github.com/mRemoteNG/mRemoteNG/issues/2706#issuecomment-3867046751`
    - `#3062`: `https://github.com/mRemoteNG/mRemoteNG/issues/3062#issuecomment-3867046757`
- [x] Re-read and regrouped unresolved upstream issues for RC handoff:
  - file:
    - `NEXTUP/RC_UNRESOLVED_REGROUP_2026-02-08.md`
  - baseline reconfirmed:
    - open issues: `830`
    - critical: `3`
    - security: `27`
    - need2check: `207`
    - in progress: `30`
    - in development: `35`
    - duplicate: `6`
    - unlabeled: `10`
- [ ] P0 issue closure workflow still pending (maintainer close decision + permissions).

## Blockers

- Local `dotnet test` via .NET SDK 10 is available through `D:\github\LOCAL\env.cmd`, but this solution still needs full Framework MSBuild for COMReference paths (`MSB4803` on .NET Core MSBuild path).
- Current release workflow is often skipped on regular pushes (trigger condition dependency).
- High warning volume remains (nullable/platform analyzer warnings), though baseline CI previously passed.

## Immediate Next Actions

1. Track upstream feedback on PR-1..PR-25 (`#3105`..`#3129`) and fast-follow any review fixes with minimal delta commits.
2. Drive maintainer close/relabel pass using `NEXTUP/RC_UNRESOLVED_REGROUP_2026-02-08.md` (critical + implemented-but-open clusters first).
3. If no parent feedback lands, refresh open-issue snapshot and package next unmapped runtime/UI candidate.

## Decision Log

- 2026-02-07: Chosen strategy is release-focused fork, with upstream sync but independent stable cadence.
- 2026-02-07: Deferred large feature PR merges (#2997, #3001) until after stable release.
- 2026-02-07: Kept .NET baseline on `net10` (current stable major).
- 2026-02-07: Full MSBuild standardized as validation path for this repo.
- 2026-02-07: Fixed arm64 ALINK blocker by enabling `GenerateSatelliteAssembliesForCore` under arm64 platform condition.
- 2026-02-07: PR validation workflow is live and green on first run.
- 2026-02-07: Security hardening PR content (#3038, #3054) is integrated in fork and locally validated.
- 2026-02-07: Implemented additional fork-side P0 hardening for LDAP path validation and import-missing-file guardrails; awaiting environment-compatible full validation.
- 2026-02-07: P0 hardening patchset is now CI-green on fork after one follow-up fix for missing test import (`using System`).
- 2026-02-07: P1-P5 triage baseline is now generated automatically and versioned in `NEXTUP`.
- 2026-02-07: P5 close-panel crash candidate (#3069) implemented and validated green in CI.
- 2026-02-07: P5 1Password candidate (#3092) implemented with parser + field extraction hardening and validated green in CI (`21782320844`).
- 2026-02-07: P1 duplicates triaged with canonical links/comments, but upstream close action is permission-blocked for current account.
- 2026-02-07: P2 batch-1 (`25` stale `Need 2 check`) triage comments executed and logged.
- 2026-02-07: P2 batch-2 (`25` additional `Need 2 check`) triage comments executed and script-automated for repeatable runs.
- 2026-02-07: P2 extended passes found `updatedAt` overlap behavior; batching automation updated to `createdAt` sorting.
- 2026-02-07: Implemented #2972 fix for default external credential provider handling in RDP/SSH protocols; validated green in CI (`21783476996`).
- 2026-02-07: P3 stale status comments executed for both `In progress` and `In development` issue sets.
- 2026-02-07: P0 mapping evidence note recorded in `NEXTUP/P0_MAPPING_2026-02-07.md`.
- 2026-02-07: Posted P0 evidence comments upstream for `#2988` and `#3080`; created maintainer handoff + upstream PR package documents.
- 2026-02-07: Opened upstream draft PR package set (`#3105`, `#3106`, `#3107`, `#3108`) on dedicated `codex/pr*` branches.
- 2026-02-07: Marked upstream package PRs as ready for review and posted CI evidence comments on each PR.
- 2026-02-07: Opened upstream PR `#3109` to unblock `#2989/#3044`; expanded fork workflows to include `x86`.
- 2026-02-07: Fixed first x86 CI regression by adding explicit x86 mappings/configurations across solution + project graph.
- 2026-02-07: Confirmed full PR validation pass with x86 enabled (`21785039669`).
- 2026-02-07: Added explicit SqlClient SNI runtime references and opened upstream PR `#3110` for `#3005`.
- 2026-02-07: Confirmed branch-head CI green after PR-6 state/doc updates (`21785223094`).
- 2026-02-07: Drove `Need 2 check` stale bucket to zero (`P2 stale >365d = 0`) via targeted comment sweep and snapshot refresh.
- 2026-02-07: Added deterministic P4 triage automation and executed first 12-comment version-label debt batch.
- 2026-02-07: Extended P4 version-label debt triage to 24 commented issues across two deterministic batches.
- 2026-02-07: Extended P4 version-label debt triage to 36 commented issues across three deterministic batches.
- 2026-02-07: Implemented panel auto-close follow-up when the last connection tab is closed.
- 2026-02-07: Validated panel auto-close follow-up in CI (`21785604947`) with full `x86/x64/ARM64` matrix green.
- 2026-02-07: Implemented #850 Config PropertyGrid splitter persistence across minimize/maximize and validated CI green (`21786942297`).
- 2026-02-07: Opened upstream PR `#3112` for #850 and posted issue/CI cross-links.
- 2026-02-08: Implemented PuTTY provider startup resilience hardening for #822 candidate and added regression coverage in `ConnectionsServicePuttySessionsResilienceTests`.
- 2026-02-08: Upgraded CI x86/x64 jobs to VS2026/MSBuild18-class hosted runners with ARM fallback to VS2022/MSBuild17.14 due current ARM image availability.
- 2026-02-08: Implemented startup XML recovery hardening for malformed `confCons.xml` (#811 candidate) with deterministic fallback to newest valid backup and regression coverage in `XmlConnectionsLoaderTests`.
- 2026-02-08: Implemented PuTTY session-name decode hardening for CJK/legacy percent-encoded registry keys (#2785 candidate) and added dedicated decoder tests.
- 2026-02-08: Validated #2785 patchset green in fork CI (`21789090820`) and opened upstream PR `#3115`.
- 2026-02-08: Refreshed P1-P5 snapshot (`NEXTUP/P1_P5_EXECUTION_2026-02-08.md`) and confirmed latest docs-sync CI green (`21789189892`).
- 2026-02-08: Implemented `#2735` SmartSize focus resilience hardening in `frmMain` (reactivation refocus + active-tab fallback lookup) and validated local build/regression subset.
- 2026-02-08: Implemented `#847` runtime guardrail so fullscreen toggle is locked while redirect-keys mode is active in fullscreen, preventing unstable exit path from tab context menu.
- 2026-02-08: Implemented `#1650` fullscreen-exit refocus hardening in `RdpProtocol` (`OnLeaveFullScreenMode` now actively restores/activates main form and refocuses session).
- 2026-02-08: Opened upstream PR package `#3116` for SmartSize focus resilience (`#2735`) with CI evidence + issue cross-link.
- 2026-02-08: Opened upstream PR package `#3117` for fullscreen/redirect-keys guardrail (`#847`) with CI evidence + issue cross-link.
- 2026-02-08: Opened upstream PR package `#3118` for fullscreen-exit refocus hardening (`#1650`) with CI evidence + issue cross-link.
- 2026-02-08: Standardized local command-feedback loop (rules + searchable logs + scripts) to preserve lessons and avoid repeated shell/tooling errors across restarts.
- 2026-02-08: Added quantitative prioritization for execution errors (frequency counters + lost-time aggregation) to focus fixes on highest operational cost first.
- 2026-02-08: Added `nx.cmd` alias runner and environment alias hooks to reduce command verbosity and improve execution/log readability.
- 2026-02-08: Hardened RDP SmartSize/resize path for RCW-disconnected COM access (`#2510` candidate), preventing runtime exception popups during resize/drag scenarios.
- 2026-02-08: Opened upstream PR `#3119` for SmartSize RCW/COM resilience (`#2510`) with issue + CI cross-links.
- 2026-02-08: Implemented settings-path observability + troubleshooting clarification for `#2987` and opened upstream PR `#3120`.
- 2026-02-08: Rebased/cleaned PR `#3120` branch onto `upstream/v1.78.2-dev` so upstream diff contains only the intended 3-file package.
- 2026-02-08: Implemented password-protection disable guardrail for `#2673` and opened upstream PR `#3121`.
- 2026-02-08: Implemented master-password autolock on minimize/idle for `#1649` and opened upstream PR `#3122`.
- 2026-02-08: Implemented external-tool `PROTOCOL` token support for `#1634` and opened upstream PR `#3123`.
- 2026-02-08: Implemented main-close cancel behavior fix for open panels (`#2270`) and opened upstream PR `#3124`.
- 2026-02-08: Posted consolidation triage comments for `#1880` and `#2653` recommending close unless reproducible on latest builds.
- 2026-02-08: Opened upstream PR `#3125` for startup XML recovery fallback package (`#811`).
- 2026-02-08: Re-grouped unresolved upstream issues for RC in `NEXTUP/RC_UNRESOLVED_REGROUP_2026-02-08.md` and aligned next actions to parent-project merge/closure gates.
- 2026-02-08: Linked issue `#811` directly to upstream PR `#3125` via parent issue comment for closure traceability.
- 2026-02-08: Linked disposed-object panel-close issue family (`#2118`, `#2163`, `#2459`, `#2706`, `#3062`) to upstream PR `#3106` to accelerate maintainer regroup/closure decisions.
- 2026-02-08: Refreshed unresolved regroup with full label-debt snapshot (`Need 2 check`, `In progress`, `In development`, unlabeled) and identified unmapped active runtime cluster (`#2160`, `#2161`, `#2171`, `#2166`).
- 2026-02-08: Identified that `#2160` is already implemented locally in commit `da963c01` (`ConnectionWindow.ClosePanelIfEmpty`) and marked it as first candidate for dedicated upstream packaging after restart.
- 2026-02-08: Packaged `#2160` into dedicated parent PR `#3126` from branch `codex/pr22-close-empty-panel-2160` and posted issue cross-link comment.
- 2026-02-08: Updated RC regroup to move `#2160` from unmapped cluster into mapped/open-PR closure debt.
- 2026-02-08: Packaged `#2161` into dedicated parent PR `#3127` from branch `codex/pr23-tab-drag-overflow-scroll-2161` and posted issue cross-link comment.
- 2026-02-08: Updated RC regroup to move `#2161` from unmapped cluster into mapped/open-PR closure debt (`#2171`, `#2166` remain next).
- 2026-02-08: Packaged `#2171` into dedicated parent PR `#3128` from branch `codex/pr24-config-tree-layout-2171` and posted issue cross-link comment.
- 2026-02-08: Updated RC regroup to move `#2171` from unmapped cluster into mapped/open-PR closure debt (`#2166` remains next).
- 2026-02-08: Packaged `#2166` into dedicated parent PR `#3129` from branch `codex/pr25-tab-crash-resize-hardening-2166` and posted issue cross-link comment.
- 2026-02-08: Updated RC regroup to map full `#2166` crash bundle across PR `#3129` (tab-close race path) and PR `#3124` (form-closing enumeration path).

## Resume Checklist (after reboot)

1. `cd /d D:\github\mRemoteNG`
2. `call D:\github\LOCAL\env.cmd`
3. `git status -sb`
4. Open this file and execute the first unchecked item in `Immediate Next Actions`.
