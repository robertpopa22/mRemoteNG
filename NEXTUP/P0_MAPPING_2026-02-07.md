# P0 Security Mapping Note

Date: 2026-02-07  
Branch: `codex/release-1.79-bootstrap`

Purpose:
- Map critical upstream issues to concrete fork commits for handoff/PR packaging.

## #2989 - Process/command injection surface

Mapped commits:
- `ef75b890` - main hardening of `Process.Start` usage.
- `31c152dd` - follow-up validation improvements from review.
- `fc854772` - regression tests for AnyDesk ID validation.
- `06e87e33` - compile/review polish.
- `a75cf606` - shell metacharacter escaping expanded (comma/semicolon).

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Connection\Protocol\AnyDesk\ProtocolAnyDesk.cs`
- `D:\github\mRemoteNG\mRemoteNG\Tools\Cmdline\CommandLineArguments.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Connection\Protocol\ProtocolAnydeskTests.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Tools\ExternalToolsArgumentParserTests.cs`

Assessment:
- High-confidence mapped and integrated.

## #3080 - LDAP query/path injection

Mapped commits:
- `3c419ded` - centralized LDAP sanitization, blocked unsafe query/fragment delimiters.
- `8680c53f` - follow-up test compile fix.

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Security\LdapPathSanitizer.cs`
- `D:\github\mRemoteNG\mRemoteNG\Config\Serializers\MiscSerializers\ActiveDirectoryDeserializer.cs`
- `D:\github\mRemoteNG\mRemoteNG\Tools\ADhelper.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Security\LdapPathSanitizerTests.cs`

Assessment:
- High-confidence mapped and integrated.

## #2988 - deserialize/RCE path

Mapped commits:
- `3c419ded` - importer hardening for missing-file scenarios and safer import flow behavior.

Relevant files:
- `D:\github\mRemoteNG\mRemoteNG\Config\Import\MRemoteNGCsvImporter.cs`
- `D:\github\mRemoteNG\mRemoteNG\Config\Import\MRemoteNGXmlImporter.cs`
- `D:\github\mRemoteNG\mRemoteNGTests\Config\Import\MRemoteNGImportersTests.cs`

Assessment:
- Partial mitigation mapped.
- Remaining recommendation: perform targeted review specifically on deserialize entry points and type constraints, then add dedicated exploit-regression tests for the claimed vector.

## Notes

- Upstream issue close/relabel cannot be executed by current account (no `CloseIssue` permission).
- Comment-level triage and evidence linking are complete; maintainer action is still required upstream.
